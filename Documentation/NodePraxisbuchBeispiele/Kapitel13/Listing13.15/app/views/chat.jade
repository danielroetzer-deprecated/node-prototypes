html
    head
        script(src="/js/jquery.js")
        script(src="http://localhost:8080/socket.io/socket.io.js")
    body
        div(style="width:500px; text-align:right;")
            a(href="/logout") Logout
        div#msgs(style="height:400px; width:400px; overflow: scroll; float:left;")
        div#users(style="height:400px; width:100px; overflow: scroll;")
        form#chatForm
            label(for="msg") #{user}:&nbsp;
            input#msg(type="text")
            button#sendBtn Send
            script.
                var socket = io.connect('http://localhost:8080');
                socket.on('connect', function () {
                    socket.emit("join", '{"name":"#{user}"}');
                });
                $('#sendBtn').on('click', function (e) {
                    e.preventDefault();
                    var name = '#{user}',
                        msg = $('#msg').val();

                    socket.emit("msg", '{"msg": "' + msg + '"}');

                    $('#msg').val('');
                });
                socket.on('msg', function (msg) {
                    var data = JSON.parse(msg);
                    var msg = $('<div>' + data.name + ': ' + data.msg + '</div>');
                    $('#msgs').append(msg);
                });
                socket.on('join', function (msg) {
                    var data = JSON.parse(msg);
                    $('#users').empty();
                    for (var i = 0; i < data.names.length; i++) {
                        var user = $('<div>' + data.names[i] + '</div>');
                        $('#users').append(user);
                    }
                });
